# Colin Knowledge Base

This directory contains the [Colin](https://colin.prefect.io) project that compiles Airflow→Prefect translation knowledge from live sources into structured JSON.

## Structure

```
colin/
├── colin.toml           # Project configuration (providers, output settings)
├── build.py             # Interim build script (until colin-py CLI is stable)
├── models/              # Source templates
│   ├── concepts.md      # Core concept mappings (DAG→Flow, XCom→return values, etc.)
│   ├── patterns.md      # Pattern translations (TaskGroup→subflow, trigger rules, etc.)
│   ├── connections.md   # Connection→Block mappings
│   ├── prefect-context.md  # Live Prefect docs (requires LLM provider)
│   └── operators/
│       ├── core.md      # Core operators (PythonOperator, BashOperator, etc.)
│       ├── sensors.md   # Sensor operators
│       ├── aws.md       # AWS provider operators
│       ├── gcp.md       # GCP provider operators
│       ├── database.md  # Database operators
│       └── _index.md    # Aggregator (all operators)
└── output/              # Compiled JSON (gitignored, regenerated by build)
```

## Building

### Quick build (interim)

The `build.py` script parses model templates into JSON without needing the Colin CLI:

```bash
uv run python colin/build.py
```

This produces JSON files in `colin/output/` that the MCP server loads at runtime.

### Full build (when colin-py is stable)

```bash
pip install colin-py --prerelease=allow
cd colin && colin run
```

The full Colin build additionally:
- Fetches live operator source code from the `apache/airflow` GitHub repo
- Queries the Prefect MCP server for current documentation
- Uses LLM blocks to summarize operator behavior

## Adding an operator

1. Choose the right template file (e.g., `models/operators/aws.md` for AWS operators)
2. Add a new `{% section OperatorName %}` block following the existing structure
3. Include: `operator`, `module`, `source_context`, `prefect_pattern`, `prefect_package`, `prefect_import`, `example` (before/after), `notes`
4. Run `uv run python colin/build.py` to rebuild

## How the MCP server uses this

The `lookup_concept` tool loads JSON from `colin/output/` at query time via `knowledge.py`. If the output directory doesn't exist, it falls back to minimal built-in mappings. The server never requires Colin to be installed — it only reads compiled JSON.
